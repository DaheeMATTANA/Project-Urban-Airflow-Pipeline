version: 2

models:
  - name: fct_hourly_station_status
    description: "Fact model of gbfs station status"
    columns:
      - name: station_id
        description: "Id of the VÃ©lib station"
        data_type: string
        tests:
          - not_null

      - name: last_reported_hourly_cet
        description: "Timestamp of the last reported time in CET/CEST (hourly granularity)"
        data_type: timestamp

      - name: last_reported_date_cet
        description: "Date of the last reported time in CET/CEST"
        data_type: date

      - name: last_reported_hour_cet
        description: "Hour of the last reported time in CET/CEST (0-23)"
        data_type: integer
        tests:
          - dbt_utils.accepted_range:
              arguments:
                min_value: 0
                max_value: 23        

      - name: avg_num_bikes_available
        description: "Number of bikes available at the time of the report"
        data_type: integer
        tests:
          - dbt_utils.accepted_range:
              arguments:
                min_value: 0
                max_value: 1000

      - name: avg_num_docks_available
        description: "Number of bike docks available (empty) at the time of the report"
        data_type: integer
        tests:
          - dbt_utils.accepted_range:
              arguments:
                min_value: 0
                max_value: 1000

      - name: pct_time_full
        description: "Percentage of time that the station was full (no available docks)."
        data_type: float

      - name: pct_time_empty
        description: "Percentage of time that the station was empty (no available bikes) "
        data_type: float

      - name: avg_num_bikes_in_maintenance
        description: "Average bikes unavailable or under maintenance of the station at the given time"
        data_type: integer

    tests:
      - dbt_utils.unique_combination_of_columns:
          arguments:
            combination_of_columns:
              - station_id
              - last_reported_hourly_cet
